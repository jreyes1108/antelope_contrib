.TH IAREQUEST 1 
.SH NAME
iarequest \- request on-demand waveforms from Internet Accelerometer Network
.SH SYNOPSIS
.nf
iarequest [-p pfname] [-c cmdorbname] [-t target] [time [endtime]]
.fi
.SH DESCRIPTION
The \fBiarequest\fP program puts a request for acquisition of
segmented waveform data onto an Antelope orbserver. The request is
to be filled by a separately-running instance of the \fBia2orb(1)\fP
program listening to that same orbserver for command packets.

If a single \fItime\fP is specified on the command line of
\fBiarequest\fP (in any format acceptable to str2epoch(3)), the
network request is constructed to acquire waveforms covering the
specified discrete point in time. If both \fItime\fP and \fIendtime\fP
are specified, the request is constructed to acquire waveforms
covering the range between the start and end time. When run with
such command-line arguments, the \fBiarequest\fP program will print on
the command line the first command-response received from the
\fBia2orb\fP program.

If no \fItime\fP or \fIendtime\fP arguments are specified on the
command-line, \fBiarequest\fP launches in a Graphical User Interface
(GUI) configuration, allowing the user to make requests interactively
via the GUI. The GUI version of the program has a pair of radiobuttons,
labeled \fIPoint\fP and \fISpan\fP, allowing the user to choose
whether to request data covering a point in time or an extended time-span.
If the \fIPoint\fP button is chosen, a single entry-box labeled
\fIStart\fP will be displayed, allowing the user to enter the point
in time the waveform data should cover, in any of the formats
acceptable to str2epoch(3)). If the \fISpan\fP button is chosen,
an additional entry-box labeled \fIEnd\fP will be displayed. In
this configuration, the data files requested are all those on the
Internet Accelerometer \fIon-demand\fP network that contain the time-span
between the specified \fIStart\fP and \fIEnd\fP times (see the
ia2orb(1) man-page for the distinction between \fIon-demand\fP and
\fIcontinuous\fP stations: the \fBiarequest\fP program affects only
data acquisition for those stations configured as \fIon-demand\fP
in the \fBia2orb\fP parameter file). The most important part of the
\fBiarequest\fP GUI window is the large green \fISend\fP button in
the middle. Until that is pressed, no actual data request is made
to \fBia2orb\fP.  When the \fISend\fP button is pressed, the data
request is sent to \fBia2orb\fP. The bottom window of the \fBiarequest\fP
GUI shows responses received from the \fBia2orb\fP instance via the
command-orb.

.SH OPTIONS
.IP "-p pfname"
Specify the parameter-file to use, overriding the default parameter-file \fIiarequest.pf\fP
.IP "-c cmdorbname"
Specify the name of the command-orb on which to place command packets, overriding the 
\fIcmdorbname\fP specified in the parameter file. 
.IP "-t target"
Specify the target name of the ia2orb(1) instance at which to direct command packets, 
overriding the \fItarget\fP specified in the parameter file. 
.SH PARAMETER FILE
.SS "Parameter File Parameters"

.IP cmdorbname
\fIiarequest\fP constructs parameter-file command packets to instruct ia2orb(1) to 
acquire particular data. The \fIcmdorbname\fP parameter specifies the name of the 
orbserver on which to put the constructed command packets, for pick-up by the ia2orb(1) 
instance. 

.IP default_gui_mode
This parameter specifies whether the default mode of \fBiarequest\fP, when launched as a GUI, 
is \fIpoint\fP (requests are for waveforms covering a single point in time) or \fIspan\fP
(requests are for waveforms covering a time span).

.IP default_request_start
This parameter specifies the default start-time for requests when \fBiarequest\fP is run as a GUI. 
For example, a value of '-00:10' for this parameter will set the start-time of requests to 
10 minutes before the current system-clock time (as explained in the time formats acceptable to 
\fIstr2epoch\fP in the man-page str2epoch(3)). Of course, the actual start time may be edited before
the request is submitted with the \fISend\fP button.

.IP target
This parameter specifies the target-name of the ia2orb(1) instance, towards which command
packets are directed. The suffix \fIpf/dlcm\fP is appended to the contents of this 
parameter in order to construct the orb source-name of the command packets generated by 
\fBiarequest\fP.

.SS "Parameter File Example"

.in 2c
.ft CW
.nf


target		ia2orb
cmdorbname	:
default_gui_mode point
default_request_start -00:10

.fi
.ft R
.in
.SH EXAMPLE
.in 2c
.ft CW
The example below shows a simple request for waveforms covering one distinct point in time. The argument, in 
single quotes, is a time-string in any of the formats interpretable by the str2epoch(3) command and documented
in that man-page: 
.nf

% iarequest '2010-04-18 3:00'
iarequest: Received response from ia2orb:
        [ia2orb thread 'command']: Issued acquisition-request to all on-demand stations for window overlapping ' 4/18/2010   3:00:00.000 UTC'

% 

.fi

Because the str2epoch(3) command is able to interpret requests for data relative to the current system-clock time, 
we can also use this feature to ask for relative times, such as to acquire waveforms containing the point in 
time 10 minutes ago. Again, see the str2epoch(3) man-page for details on this formatting trick. As a small point
of Unix trivia, in order to get this to work with relative (negative) times, one has to precede the time value 
with a "--" to indicate to the \fBiarequest\fP command that all hyphenated option-arguments have been given 
and the next item is a command-line argument that should not be interpreted as one of the OPTION items listed 
above (this "--" trick is a standard Unix feature, though one perhaps not as widely known as some others): 

.nf

% iarequest -- '-00:10'
iarequest: Received response from ia2orb:
        [ia2orb thread 'command']: Issued acquisition-request to all on-demand stations for window overlapping ' 4/18/2010   3:36:05.588 UTC'

% 

.fi
.ft R
.in
.SH "SEE ALSO"
.nf
ia2orb(1)
.fi
.SH "BUGS AND CAVEATS"
Don't forget to hit the \fISend\fP button in the GUI after setting the time or times for your
data request.

When \fBiarequest\fP runs in non-GUI mode, only the first response from \fBia2orb\fP is 
printed before exiting. When \fBiarequest\fP is run in GUI mode, all responses from \fBia2orb\fP
are printed in the scrolling text box, however this may include responses to other instances 
of \fBiarequest\fP as well as to instances of \fBiatrigger(1)\fP. This allows the \fBiarequest\fP user 
to better understand all data requests being undertaken by \fBia2orb(1)\fP from the Internet
Accelerometer network.
.SH AUTHOR
.nf
Kent Lindquist
Lindquist Consulting, Inc.
.fi
